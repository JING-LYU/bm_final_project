---
title: "Yushan Wang"
output: github_document
---

```{r, echo = FALSE, message=FALSE}
library(tidyverse)

```

## Variable information:

```{r}
var <- c("id", "cty", "state", "area",	"pop", "pop18",	"pop65",	"docs",	"beds",	"crimes",	"hsgrad",	"bagrad",	"poverty",	"unemp",	"pcincome",	"totalinc",	"region")

var_meaning <- c("ID number", "
County name", "State name", "Land area", "Total population", "Percent of population aged 18-34", "Percent of population aged 65+", "Number of active physicians", "Number of hospital beds", "Total serious crimes", "Percent high school graduates", "Percent bachelorâ€™s degrees
", "Percent below poverty level", "Percent unemployment", "Per capita income", "Total personal income", "Geographic region")

var_info <- data.frame(var, var_meaning)

knitr::kable(var_info)
```


```{r}
cdi_data = read.csv("./data/cdi.csv") %>%
  janitor::clean_names() %>%
  mutate(crime_rate = crimes/pop) 
  
```


poverty vs crime rate

```{r}
reg <- lm(crime_rate ~ poverty, data = cdi_data)
summary(reg)



ggplot(data = cdi_data, aes(x = poverty, y = crime_rate)) + 
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", se = FALSE)
```


poverty vs pop vs age group

```{r}
# correlation between age group?
cor(cdi_data$pop18, cdi_data$pop65)
# yes, there is strong correlation between two age group, consider removing one

# Simple linear regression: crm_1000 vs poverty
cdi_pov = lm(crime_rate_1000 ~ poverty, data = cdi_data)
summary(cdi_pov)

# poverty + population
cdi_pov_pop = lm(crime_rate_1000 ~ poverty + pop, data = cdi_data)
summary(cdi_pov_pop)
# consider population as interactive term

# poverty + age 18-34
cdi_pov_pop18 = lm(crime_rate_1000 ~ poverty + pop18 , data = cdi_data)
summary(cdi_pov_pop18)

# poverty + age 65
cdi_pov_pop65 = lm(crime_rate_1000 ~ poverty + pop65 , data = cdi_data)
summary(cdi_pov_pop65)

# poverty + age 18 + age 65
cdi_pov_pop18_pop65 = lm(crime_rate_1000 ~ poverty + pop18 + pop65 , data = cdi_data)
summary(cdi_pov_pop18_pop65)

# age65 not significant, remove

```

best subset test
```{r}

bs<-BestSub(cdi_data[,c(6:17)],cdi_data$crime_rate_1000, method = "sse", num=1) # best subset


```

